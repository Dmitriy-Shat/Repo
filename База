from time import sleep

class Video:
    
    def __init__(self, title, duration, adult_mode):
        self.title = title
        self.duration = duration
        self.adult_mode = adult_mode
        
    def __repr__(self):
        return f"{self.title}, {self.duration}, {self.adult_mode}"

class UrTube:

    def __init__(self):
        self.users = []
        self.videos = []
        self.watch = []

    #def __str__(self):
        #return str(self.users)

    def __repr__(self):
        return repr(self.videos)

    def add(self, *video):
        for i in video:
            count_name = 0
            for j in video:
                if i.title in j.title:
                    count_name += 1
            if count_name == 1:
                self.videos.append(i)
            elif count_name >= 2:
                self.videos.append(i)
                break
                
    def get_videos(self, search):
        for i in self.videos:
            count = 1
            if search.upper() in i.title.upper():
                print(f"Найденное видео: {count}) {i}\n")
                count += 1
                self.watch.append(i)
        
    def watch_video(self):
        for i in self.watch:
            print(i)
        
    def register(self, nickname, password, age):
        new_user = []
        new_user.append(nickname)
        new_user.append(hash(password))
        new_user.append(age)
        self.users.append(new_user)
        count_name = 0
        for index in self.users:
            if nickname in index:
                count_name += 1
        if count_name <= 1:
            print(f"Регистрация прошла успешно. Здравствуйте {nickname}\n")
        else:
            print(f"Пользователь с ником {nickname} уже существует.\n")
            self.users.pop()

    def log_in(self, nickname, password):
        for index in self.users:
            if nickname in index and hash(password) in index:
                print(f"Добро пожаловать {nickname}!\n")
                break
            elif nickname in index or hash(password) in index:
                print("Неверный логин или пароль\n")
                break
            else:
                print("Такого пользователя нет.\n")

    def log_out(self):
        exit()
        
ur = UrTube()

v1 = Video("Неустрашимый", 12, False)
v2 = Video("Дедпул", 15, True)
v3 = Video("Неуставший", 15, True)
v4 = Video("Кингсман", 10, False)
v5 = Video("Кингсман", 10, False)

ur.add(v1, v2, v3, v4,v5)
#print(ur)

curent_user = False

while True:
    choice = int(input("Приветствую выберите действие:\n1 - Вход\n2 - Регистрация\n3 - Выход\n"))
    if choice == 2:
        ur.register(nickname := input("Введите ник: "), password := input("Введите пароль: "),
            input("Введите возраст: "))
        #print(f"{ur}\n")
        continue
    elif choice == 1:
        ur.log_in(nickname := input("Введите ник: "), password := input("Введите пароль: "))
        curent_user = True
        while curent_user:
            window = int(input("Выберите действие:\n1 - Поиск видео\n2 - Выход из аккаунта\n"))
            if window == 1:
                ur.get_videos(input("Введите название фильма: "))
                ur.watch_video()
            elif window == 2:
                ur.log_out()
    elif choice == 3:
        exit()
